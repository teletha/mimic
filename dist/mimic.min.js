const noop=()=>{},isString=e=>"string"==typeof e||e instanceof String,parseHTML=e=>{let t=document.createElement("template");return t.innerHTML=e,e.startsWith("<o-")&&Mimic(t.content).children().add("mimic"),t.content},all=function*(e,t,n){let l=n?isString(n)?e=>e.matches(n):e=>e===n:e=>!1;for(;(e=t(e))&&!l(e);)yield e},flat=(e,t=0)=>function(...n){let l=[...new Set(this.nodes.flatMap(t=>e(t,...n)))];return Mimic(n[t]?l.filter(e=>e.matches(n[t])):l)},self=e=>function(...t){return Mimic(this.nodes.map(n=>e(n,...t)||n))},value=e=>function(...t){if("function"==typeof t[0]){let e=this.closest(".mimic").nodes[0];if(e){let n=e.mimic||(e.mimic={});(n.renders||(n.renders=[])).push(t[0])}t[0]=t[0]()}let n=this.nodes.map(n=>e(n,...t))[0];return void 0===n||n===t[t.length-1]?this:n},nodify=(e,t)=>{e instanceof Element||e instanceof Text||e instanceof ShadowRoot?t(e):Array.isArray(e)?e.forEach(e=>nodify(e,t)):isString(e)?t("<"===e.trim()[0]?parseHTML(e):$(e)):e instanceof Mimic&&nodify(e.nodes,t)};function Mimic(e){let t=Object.create(this?this.constructor.prototype:Mimic.prototype);return t.nodes=isString(e)?[..."<"===e.trim()[0]?parseHTML(e).children:document.querySelectorAll(e)]:Array.isArray(e)?e:e?e instanceof Node?[e]:e instanceof Mimic?[...e.nodes]:[...e]:[document],t}function activatable(e,t){if(e.closest){let n=e.closest(".mimic");if(n){let e=n.mimic||(n.mimic={});1===(++e[t]||(e[t]=1))&&n.addEventListener(t,t=>{var l;console.log("need redraw ",n,t,e),null==(l=e.renders)||l.forEach(e=>e())})}}}Mimic.prototype={each:self((e,t)=>t(e)),contain:flat((e,t)=>e.querySelector(t)?e:[],9),filter:flat((e,t)=>t(e)?e:[],9),is:flat((e,t)=>e.matches(t)?e:[],9),parent:flat(e=>e.parentNode),parents:flat(e=>[...all(e,e=>e.parentElement)]),closest:self((e,t)=>e.closest(t)),children:flat(e=>[...e.children]),find:flat((e,t)=>[...e.querySelectorAll(t)],9),first:flat(e=>e.firstElementChild),last:flat(e=>e.lastElementChild),prev:flat(e=>e.previousElementSibling),prevs:flat(e=>[...all(e,e=>e.previousElementSibling)]),prevUntil:flat((e,t)=>[...all(e,e=>e.previousElementSibling,t)],1),next:flat(e=>e.nextElementSibling),nexts:flat(e=>[...all(e,e=>e.nextElementSibling)]),nextUntil:flat((e,t)=>[...all(e,e=>e.nextElementSibling,t)],1),append:self((e,t)=>nodify(t,t=>e.append(t))),appendTo:self((e,t)=>nodify(t,t=>t.append(e))),prepend:self((e,t)=>nodify(t,t=>e.prepend(t))),prependTo:self((e,t)=>nodify(t,t=>t.prepend(e))),before:self((e,t)=>nodify(t,t=>e.before(t))),insertBefore:self((e,t)=>nodify(t,t=>t.before(e))),after:self((e,t)=>nodify(t,t=>e.after(t))),insertAfter:self((e,t)=>nodify(t,t=>t.after(e))),clone:self(e=>e.cloneNode()),make:flat((e,t,n,l)=>l?n.map(n=>{let i=Mimic(e).make(t).model(n);return l(n,i),i}).flatMap(e=>e.nodes):e.appendChild(document.createElement(t)),9),svg:flat((e,t)=>e.appendChild(Mimic(`<svg class='svg ${t.substring(t.indexOf("#")+1)}' viewBox='0 0 24 24'><use href='${t}'/></svg>`).nodes[0]),9),empty:self(e=>e.replaceChildren()),clear:self(e=>e.parentNode.removeChild(e)),html:value((e,t)=>t?e.innerHTML=t:e.innerHTML),text:value((e,t)=>t?e.textContent=t:e.textContent),attr:value((e,t,n)=>n?e.setAttribute(t,n):e.getAttribute(t)),data:value((e,t,n)=>n?e.dataset[t]=n:e.dataset[t]),css:self((e,t)=>isString(t)?e.style.cssText=t:Object.keys(t).forEach(n=>e.style[n]=t[n])),model:value((e,t)=>void 0!==t?e.model=t:e.model),value:value((e,t)=>void 0!==t?e.value=t:e.value),toString:value(e=>e.outerHTML),add:value((e,t)=>e.classList.add(t)),remove:value((e,t)=>e.classList.remove(t)),toggle:value((e,t,n=noop,l=noop)=>e.classList.toggle(t)?n():l()),has:value((e,t)=>e.classList.contains(t)),set:value((e,t)=>Object.keys(t).forEach(n=>e.classList[t[n]?"add":"remove"](n))),reset:value((e,t)=>e.className=t||""),on:value((e,t,n,l)=>{activatable(e,t),setTimeout(()=>e.addEventListener(t,(null==l?void 0:l.where)?e=>e.target.matches(l.where+","+l.where+" *")?n(e):null:n,l),0)}),off:value((e,t,n)=>e.removeEventListener(t,n)),dispatch:self((e,t)=>e.dispatchEvent(new Event(t,{bubbles:!0}))),show:self((e,t)=>e.style.display=t?"":"none")},"blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change input select submit keydown keypress keyup contextmenu".split(" ").forEach(e=>{Mimic.prototype[e]=function(t,n){return this.on(e,t,n)}}),"id title href placeholder label name src type".split(" ").forEach(e=>{Mimic.prototype[e]=function(t){return this.attr(e,t)}});export{Mimic};
//# sourceMappingURL=mimic.min.js.map
